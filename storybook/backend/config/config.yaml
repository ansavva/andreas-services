# Storybook Backend Configuration
# Edit these settings to customize AI generation and style references

# Style reference images configuration
style_references:
  animated_3d:
    filename: "animated_3d_reference.png"
    description: "High-quality 3D animated character style"

# Prompt files configuration
# Prompts are stored as markdown files in assets/prompts/ for better editing
prompts:
  # Style Transfer prompts (recommended method)
  style_transfer_prompt: "prompts/style_transfer_prompt.md"
  style_transfer_negative: "prompts/style_transfer_negative.md"

  # Legacy image-to-image prompts
  character_base_prompt: "prompts/character_base_prompt.md"
  character_negative_prompt: "prompts/character_negative_prompt.md"

  # Story illustration prompts
  story_negative_prompt: "prompts/story_negative_prompt.md"

character:
  # Style strength for style transfer (0.0-1.0)
  # Higher = more stylized, Lower = more like original photo
  # Recommended: 0.7-0.9 for good stylization while preserving likeness
  style_strength: 0.7

  # Default style reference image for style transfer
  # Maps to a style reference image in assets/styles/
  default_style_reference: "animated_3d"

  # Default Stability AI style preset (legacy image-to-image only)
  # Only used by the old /portrait endpoint, not the recommended /portrait-stylized endpoint
  default_style_preset: "3d-model"

  # Image generation parameters
  # Lower value = more likeness to reference photos, less stylization
  # Higher value = more stylization, risk of drift from reference
  # Recommended range: 0.35-0.45 for good balance
  image_strength: 0.4  # How much to use reference photo (0.0-1.0)

story_illustrations:
  # Image generation parameters
  image_strength: 0.28

# Replicate SDXL Model Configuration
# Reference: https://replicate.com/blog/fine-tune-sdxl
replicate:
  # Account configuration
  owner: "ansavva"  # Replicate account username
  default_profile: "stability"

  stability:
    label: "Stability SDXL (Recommended)"
    description: "Best likeness. Uses a subject-specific token automatically."
    use_subject_token: true
    model_name_template: "stability_{user_id}_{project_id}"
    training:
      steps: 1500
      learning_rate: 0.0002
      batch_size: 4
      resolution: 768
      autocaption: true
      caption_dropout_rate: 0.05
      optimizer: "adamw8bit"
      trigger_word: null
      token_string: "TOK"
      is_lora: true
      unet_learning_rate: 0.000001
      hardware: "gpu-t4"
      visibility: "private"
      trainer_version: "stability-ai/sdxl:39ed52f2a78e934b3ba6e2a89f5b1c712de7dfea535525255b1aa35c5565e08b"
    generation:
      model: "dev"
      aspect_ratio: "1:1"
      num_outputs: 1
      output_format: "jpg"
      output_quality: 90
      lora_scale: 1.0
      guidance_scale: 3.5
      prompt_strength: 0.8
      num_inference_steps: 28
      extra_lora_scale: 1.0
      disable_safety_checker: true

  flux:
    label: "Flux"
    description: "Fine-tune that behaves like our original FLUX workflow."
    use_subject_token: false
    model_name_template: "flux_{user_id}_{project_id}"
    training:
      steps: 1000
      learning_rate: 0.0001
      batch_size: 4
      resolution: 768
      autocaption: true
      caption_dropout_rate: 0.05
      optimizer: "adamw8bit"
      trigger_word: null
      token_string: "TOK"
      is_lora: true
      unet_learning_rate: 0.000001
      hardware: "gpu-t4"
      visibility: "private"
      trainer_version: "ostris/flux-dev-lora-trainer:4ffd32160efd92e956d39c5338a9b8fbafca58e03f791f6d8011f3e20e8ea6fa"
    generation:
      model: "dev"
      aspect_ratio: "1:1"
      num_outputs: 1
      output_format: "jpg"
      output_quality: 90
      lora_scale: 1.0
      guidance_scale: 3.5
      prompt_strength: 0.8
      num_inference_steps: 28
      extra_lora_scale: 1.0
      disable_safety_checker: true

  flux_pro:
    label: "Flux 1.1 Pro"
    description: "Fine-tune and generate with the Flux 1.1 Pro capabilities."
    use_subject_token: false
    model_name_template: "flux11_{user_id}_{project_id}"
    training:
      steps: 1200
      learning_rate: 0.00015
      batch_size: 4
      resolution: 768
      autocaption: true
      caption_dropout_rate: 0.05
      optimizer: "adamw8bit"
      trigger_word: null
      token_string: "TOK"
      is_lora: true
      unet_learning_rate: 0.000001
      hardware: "gpu-t4"
      visibility: "private"
      trainer_version: "ostris/flux-dev-lora-trainer:4ffd32160efd92e956d39c5338a9b8fbafca58e03f791f6d8011f3e20e8ea6fa"
    generation:
      model: "dev"
      aspect_ratio: "1:1"
      num_outputs: 1
      output_format: "jpg"
      output_quality: 90
      lora_scale: 1.0
      guidance_scale: 3.5
      prompt_strength: 0.8
      num_inference_steps: 28
      extra_lora_scale: 1.0
      disable_safety_checker: true

# Available style presets from Stability AI
# See: https://platform.stability.ai/docs/api-reference#tag/v1generation/operation/textToImage
style_presets:
  - "3d-model"
  - "analog-film"
  - "anime"
  - "cinematic"
  - "comic-book"
  - "digital-art"
  - "enhance"
  - "fantasy-art"
  - "isometric"
  - "line-art"
  - "low-poly"
  - "modeling-compound"
  - "neon-punk"
  - "origami"
  - "photographic"
  - "pixel-art"
  - "tile-texture"
