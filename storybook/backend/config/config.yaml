# Storybook Backend Configuration
# Edit these settings to customize AI generation and style references

# Style reference images configuration
style_references:
  animated_3d:
    filename: "animated_3d_reference.png"
    description: "High-quality 3D animated character style"

# Prompt files configuration
# Prompts are stored as markdown files in assets/prompts/ for better editing
prompts:
  # Style Transfer prompts (recommended method)
  style_transfer_prompt: "prompts/style_transfer_prompt.md"
  style_transfer_negative: "prompts/style_transfer_negative.md"

  # Legacy image-to-image prompts
  character_base_prompt: "prompts/character_base_prompt.md"
  character_negative_prompt: "prompts/character_negative_prompt.md"

  # Story illustration prompts
  story_negative_prompt: "prompts/story_negative_prompt.md"

character:
  # Style strength for style transfer (0.0-1.0)
  # Higher = more stylized, Lower = more like original photo
  # Recommended: 0.7-0.9 for good stylization while preserving likeness
  style_strength: 0.7

  # Default style reference image for style transfer
  # Maps to a style reference image in assets/styles/
  default_style_reference: "animated_3d"

  # Default Stability AI style preset (legacy image-to-image only)
  # Only used by the old /portrait endpoint, not the recommended /portrait-stylized endpoint
  default_style_preset: "3d-model"

  # Image generation parameters
  # Lower value = more likeness to reference photos, less stylization
  # Higher value = more stylization, risk of drift from reference
  # Recommended range: 0.35-0.45 for good balance
  image_strength: 0.4  # How much to use reference photo (0.0-1.0)

story_illustrations:
  # Image generation parameters
  image_strength: 0.28

# Replicate FLUX Model Configuration
# Reference: https://replicate.com/blog/fine-tune-flux
replicate:
  # Account configuration
  owner: "ansavva"  # Replicate account username

  # Training configuration
  training:
    steps: 1000  # Number of training steps
    learning_rate: 0.0004  # Learning rate for training
    batch_size: 1  # Training batch size
    resolution: "512,768,1024"  # Training resolutions (comma-separated)
    autocaption: true  # Automatically caption images
    caption_dropout_rate: 0.05  # Rate to drop captions during training
    optimizer: "adamw8bit"  # Optimizer type
    trigger_word: null  # Optional trigger word for model
    hardware: "gpu-t4"  # Hardware specification
    visibility: "private"  # Model visibility (public or private)
    trainer_version: "ostris/flux-dev-lora-trainer:4ffd32160efd92e956d39c5338a9b8fbafca58e03f791f6d8011f3e20e8ea6fa"

  # Generation configuration
  generation:
    model: "dev"  # Model type
    aspect_ratio: "1:1"  # Output aspect ratio
    num_outputs: 1  # Number of images to generate
    output_format: "jpg"  # Output format (jpg or png)
    output_quality: 90  # Output quality (1-100)
    lora_scale: 1.0  # LoRA scale (strength of fine-tuning)
    guidance_scale: 3.5  # How strictly to follow prompt
    prompt_strength: 0.8  # Prompt adherence strength
    num_inference_steps: 28  # Number of denoising steps
    extra_lora_scale: 1.0  # Additional LoRA scaling
    disable_safety_checker: true  # Disable safety checker

# Available style presets from Stability AI
# See: https://platform.stability.ai/docs/api-reference#tag/v1generation/operation/textToImage
style_presets:
  - "3d-model"
  - "analog-film"
  - "anime"
  - "cinematic"
  - "comic-book"
  - "digital-art"
  - "enhance"
  - "fantasy-art"
  - "isometric"
  - "line-art"
  - "low-poly"
  - "modeling-compound"
  - "neon-punk"
  - "origami"
  - "photographic"
  - "pixel-art"
  - "tile-texture"